# 2020年12月1日

MQTTサーバーの各種設定をDockerfile化する作業が続いている。
証明書関連の問題でSSL対応のサーバーが開店休業してしまうのは脆すぎる。
最低でもホスト名を分けて、SSL対応を2つと非対応1つの体制にしておきたい。

なぜ、SSL非対応のサーバーは1つで良いのかについては

 - HTTPで送り出したページからは、SSL対応、非対応の双方に接続できる
 - HTTPSで送り出したページからは、SSL対応のコンテンツにしか繋げられない

という制約があるためで

JavaScriptからMQTTのデータ読めるようにするライブラリで使われている。
WebSocketの扱いは特に厳しく、SSL非対応のサーバーに接続しようとするだけで、
ブラウザが止めてしまって何もできない。

# 2020年12月2日

毎月2回、管理画面のCPU負荷グラフのスナップショットを撮っているが
取り忘れないように自動化したい。

# 2020年12月4日

今日はアクセスが多めなので、スナップショットから新規マシンを作って作業
1日起動させて1ドルもかからないことを考えると、この方法で色々と作業したほうが健全な気がするなぁ

と本番環境でやらかしちゃった人Advent Calendarを見て思うのだった。
