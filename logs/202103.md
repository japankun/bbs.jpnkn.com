# 2021年3月4日

- 書き込みで発火された MQTT メッセージを受信して、S3 に転送するテストしている。
- 書き込み → MQTT送信 → Node-RED で MQTT 受信 → HTTP 経由で dat を取りに行く → 受信した dat を S3 に保管する。

## 月間の書き込みが 50 万回 の場合・・・
- 贅沢に dat + subject.txt + SETTING.TXT を全部更新して PUT 150 万回とする。
- 念の為 GET も同じ数で見積もってみる。
- 削除で発生するデータの更新は考慮しない。

```
Tiered price for: 2 GB
2 GB x 0.0250000000 USD = 0.05 USD
合計階層コスト = 0.0500 USD (S3 Standard storage cost)
1,500,000 PUT requests for S3 Storage x 0.0000047 USD per request = 7.05 USD (S3 Standard PUT requests cost)
1,500,000 GET requests in a month x 0.00000037 USD per request = 0.555 USD (S3 Standard GET requests cost)
0.05 USD + 0.555 USD + 7.05 USD = 7.66 USD (Total S3 Standard Storage, data requests, S3 select cost)
S3 標準のコスト (monthly): 7.66 USD
```

## 課題
- これをバックアップ以外に活かせるかがまだ見いだせていないこと。
- 既知の不具合が起きるブラウザ用の救済サーバー (Mekacast など)
- dat 配信を S3 だけで完結・・・するには GET の回数がネック
- モダンな視聴ツールじゃないと 302:Found / 307:Temporary Redirect を読んでくれない気がする。
